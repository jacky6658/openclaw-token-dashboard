# ðŸ“¦ æ‰“åŒ…å®‰è£æ–¹æ¡ˆ - macOS & Windows

> è®“ Dashboard è®Šæˆå°ˆæ¥­çš„ä¸€éµå®‰è£æ‡‰ç”¨

---

## ðŸŽ¯ å…©ç¨®æ‰“åŒ…æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šElectron æ¡Œé¢æ‡‰ç”¨ â­ æŽ¨è–¦
**æœ€å°ˆæ¥­ã€è·¨å¹³å°ã€ä¸€éµå®‰è£**

### æ–¹æ¡ˆäºŒï¼šå‚³çµ±å®‰è£åŒ…
**Mac .pkg / Windows .exe**

---

## ðŸš€ æ–¹æ¡ˆä¸€ï¼šElectron æ¡Œé¢æ‡‰ç”¨ï¼ˆæŽ¨è–¦ï¼‰

### ç‚ºä»€éº¼é¸æ“‡ Electronï¼Ÿ

âœ… **è·¨å¹³å°æ”¯æ´**
- macOS: `.app` / `.dmg`
- Windows: `.exe` å®‰è£ç¨‹å¼
- Linux: `.AppImage` / `.deb` / `.rpm`

âœ… **å°ˆæ¥­åŠŸèƒ½**
- ç¨ç«‹æ‡‰ç”¨åœ–ç¤º
- ç³»çµ±æ‰˜ç›¤å¸¸é§
- è‡ªå‹•å•Ÿå‹•é¸é …
- è‡ªå‹•æ›´æ–°
- åŽŸç”Ÿé€šçŸ¥
- ä¸éœ€è¦ç”¨æˆ¶å®‰è£ Node.js

âœ… **ä½¿ç”¨é«”é©—**
- é›™æ“Š `.exe` æˆ– `.pkg` è‡ªå‹•å®‰è£
- åƒä½¿ç”¨æ™®é€šè»Ÿé«”ä¸€æ¨£
- ä¸é¡¯ç¤ºçµ‚ç«¯æ©Ÿè¦–çª—
- èƒŒæ™¯é‹è¡Œ

---

## ðŸ“¦ æ–¹æ¡ˆä¸€å¯¦ä½œæ­¥é©Ÿ

### 1. å®‰è£ Electron ç›¸é—œå¥—ä»¶

```bash
cd /Users/user/clawd/projects/token-dashboard

# å®‰è£ Electron åŠæ‰“åŒ…å·¥å…·
npm install --save-dev electron electron-builder

# å®‰è£é¡å¤–ä¾è³´
npm install electron-store
```

### 2. å‰µå»º Electron ä¸»ç¨‹å¼

å‰µå»º `electron-main.js`ï¼š

```javascript
const { app, BrowserWindow, Tray, Menu, nativeImage } = require('electron');
const path = require('path');
const { spawn } = require('child_process');
const express = require('express');

let mainWindow = null;
let tray = null;
let serverProcess = null;

// å•Ÿå‹•å¾Œç«¯ä¼ºæœå™¨
function startBackendServer() {
  const server = require('./backend/server.js');
  console.log('âœ… å¾Œç«¯ä¼ºæœå™¨å·²å•Ÿå‹•');
}

// å‰µå»ºä¸»è¦–çª—
function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1400,
    height: 900,
    title: 'OpenClaw Token Dashboard',
    icon: path.join(__dirname, 'assets/icon.png'),
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true
    }
  });

  // è¼‰å…¥ Dashboard
  mainWindow.loadURL('http://localhost:3737');

  // è¦–çª—é—œé–‰æ™‚æœ€å°åŒ–åˆ°ç³»çµ±æ‰˜ç›¤
  mainWindow.on('close', (event) => {
    if (!app.isQuitting) {
      event.preventDefault();
      mainWindow.hide();
    }
  });
}

// å‰µå»ºç³»çµ±æ‰˜ç›¤åœ–ç¤º
function createTray() {
  const icon = nativeImage.createFromPath(path.join(__dirname, 'assets/tray-icon.png'));
  tray = new Tray(icon.resize({ width: 16, height: 16 }));

  const contextMenu = Menu.buildFromTemplate([
    {
      label: 'é¡¯ç¤º Dashboard',
      click: () => {
        mainWindow.show();
      }
    },
    {
      label: 'é‡æ–°æ•´ç†',
      click: () => {
        mainWindow.reload();
      }
    },
    { type: 'separator' },
    {
      label: 'é–‹æ©Ÿè‡ªå‹•å•Ÿå‹•',
      type: 'checkbox',
      checked: app.getLoginItemSettings().openAtLogin,
      click: (menuItem) => {
        app.setLoginItemSettings({
          openAtLogin: menuItem.checked
        });
      }
    },
    { type: 'separator' },
    {
      label: 'çµæŸç¨‹å¼',
      click: () => {
        app.isQuitting = true;
        app.quit();
      }
    }
  ]);

  tray.setToolTip('OpenClaw Token Dashboard');
  tray.setContextMenu(contextMenu);

  // é»žæ“Šæ‰˜ç›¤åœ–ç¤ºé¡¯ç¤ºè¦–çª—
  tray.on('click', () => {
    mainWindow.show();
  });
}

// æ‡‰ç”¨å•Ÿå‹•
app.whenReady().then(() => {
  // å•Ÿå‹•å¾Œç«¯
  startBackendServer();
  
  // ç­‰å¾…å¾Œç«¯å•Ÿå‹•
  setTimeout(() => {
    createWindow();
    createTray();
  }, 2000);

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow();
    }
  });
});

// æ‡‰ç”¨é€€å‡º
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});

app.on('before-quit', () => {
  app.isQuitting = true;
});
```

### 3. ä¿®æ”¹ package.json

```json
{
  "name": "openclaw-token-dashboard",
  "version": "2.0.0",
  "description": "OpenClaw Token ç›£æŽ§å·¥å…· - è³½åšæœ‹å…‹é¢¨æ ¼",
  "main": "electron-main.js",
  "scripts": {
    "start": "electron .",
    "dev": "electron . --dev",
    "build": "electron-builder",
    "build:mac": "electron-builder --mac",
    "build:win": "electron-builder --win",
    "build:linux": "electron-builder --linux",
    "build:all": "electron-builder --mac --win --linux"
  },
  "build": {
    "appId": "com.openclaw.token-dashboard",
    "productName": "OpenClaw Token Dashboard",
    "copyright": "Copyright Â© 2026",
    "mac": {
      "category": "public.app-category.developer-tools",
      "icon": "assets/icon.icns",
      "target": [
        {
          "target": "dmg",
          "arch": ["x64", "arm64"]
        },
        {
          "target": "pkg",
          "arch": ["x64", "arm64"]
        }
      ],
      "darkModeSupport": true
    },
    "win": {
      "icon": "assets/icon.ico",
      "target": [
        {
          "target": "nsis",
          "arch": ["x64"]
        }
      ]
    },
    "linux": {
      "icon": "assets/icon.png",
      "target": [
        "AppImage",
        "deb",
        "rpm"
      ],
      "category": "Development"
    },
    "files": [
      "electron-main.js",
      "backend/**/*",
      "frontend/**/*",
      "node_modules/**/*",
      "assets/**/*",
      "package.json"
    ],
    "directories": {
      "buildResources": "assets",
      "output": "dist"
    }
  },
  "dependencies": {
    "express": "^4.18.2",
    "sqlite3": "^5.1.6",
    "electron-store": "^8.1.0"
  },
  "devDependencies": {
    "electron": "^28.0.0",
    "electron-builder": "^24.9.1"
  }
}
```

### 4. æº–å‚™åœ–ç¤º

éœ€è¦å‰µå»ºä»¥ä¸‹åœ–ç¤ºæª”æ¡ˆï¼š

```
assets/
â”œâ”€â”€ icon.png       # 1024x1024 PNG
â”œâ”€â”€ icon.icns      # macOS åœ–ç¤º
â”œâ”€â”€ icon.ico       # Windows åœ–ç¤º
â””â”€â”€ tray-icon.png  # ç³»çµ±æ‰˜ç›¤åœ–ç¤º (16x16 æˆ– 32x32)
```

**è£½ä½œåœ–ç¤ºå·¥å…·ï¼š**
- macOS `.icns`: ä½¿ç”¨ `png2icns` æˆ–ç·šä¸Šå·¥å…·
- Windows `.ico`: ä½¿ç”¨ `png2ico` æˆ–ç·šä¸Šå·¥å…·

### 5. æ‰“åŒ…æŒ‡ä»¤

```bash
# macOS æ‰“åŒ…
npm run build:mac
# ç”¢ç”Ÿ: dist/OpenClaw Token Dashboard-2.0.0.dmg
#       dist/OpenClaw Token Dashboard-2.0.0.pkg

# Windows æ‰“åŒ…ï¼ˆéœ€è¦åœ¨ Windows ä¸Šæˆ–ä½¿ç”¨ wineï¼‰
npm run build:win
# ç”¢ç”Ÿ: dist/OpenClaw Token Dashboard Setup 2.0.0.exe

# å…¨å¹³å°æ‰“åŒ…
npm run build:all
```

### 6. å®‰è£é«”é©—

**macOS:**
```
1. é›™æ“Š .pkg æª”æ¡ˆ
2. è·Ÿéš¨å®‰è£ç²¾éˆ
3. æ‹–æ‹½åˆ°ã€Œæ‡‰ç”¨ç¨‹å¼ã€è³‡æ–™å¤¾
4. âœ… å®Œæˆï¼å¾ž Launchpad å•Ÿå‹•
```

**Windows:**
```
1. é›™æ“Š .exe å®‰è£ç¨‹å¼
2. é¸æ“‡å®‰è£ä½ç½®
3. å‰µå»ºæ¡Œé¢æ·å¾‘
4. âœ… å®Œæˆï¼å¾žæ¡Œé¢å•Ÿå‹•
```

---

## ðŸ“¦ æ–¹æ¡ˆäºŒï¼šå‚³çµ±å®‰è£åŒ…

### macOS .pkg æ‰“åŒ…

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ pkgbuild (å‘½ä»¤è¡Œ)

```bash
#!/bin/bash
# å‰µå»º build-pkg.sh

APP_NAME="OpenClaw Token Dashboard"
VERSION="2.0.0"
IDENTIFIER="com.openclaw.token-dashboard"
INSTALL_LOCATION="/Applications/OpenClaw Dashboard"

# 1. æº–å‚™æª”æ¡ˆçµæ§‹
mkdir -p build/root/Applications/OpenClaw\ Dashboard
cp -r * build/root/Applications/OpenClaw\ Dashboard/

# 2. å‰µå»ºå®‰è£è…³æœ¬
cat > build/scripts/postinstall << 'EOF'
#!/bin/bash
cd "/Applications/OpenClaw Dashboard"
npm install --production
chmod +x "å•Ÿå‹• Dashboard.command"
EOF

chmod +x build/scripts/postinstall

# 3. å»ºç«‹ component package
pkgbuild \
  --root build/root \
  --scripts build/scripts \
  --identifier "$IDENTIFIER" \
  --version "$VERSION" \
  --install-location "/" \
  build/component.pkg

# 4. å»ºç«‹ product package
productbuild \
  --package build/component.pkg \
  --identifier "$IDENTIFIER" \
  --version "$VERSION" \
  "dist/$APP_NAME-$VERSION.pkg"

echo "âœ… PKG å·²å‰µå»º: dist/$APP_NAME-$VERSION.pkg"
```

åŸ·è¡Œï¼š
```bash
chmod +x build-pkg.sh
./build-pkg.sh
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨ Packages (åœ–å½¢åŒ–å·¥å…·)

1. **ä¸‹è¼‰ Packages:**
   - http://s.sudre.free.fr/Software/Packages/about.html
   - å…è²»çš„ macOS æ‰“åŒ…å·¥å…·

2. **è¨­å®šæ­¥é©Ÿ:**
   - æ–°å¢žå°ˆæ¡ˆ
   - è¨­å®šæ‡‰ç”¨ç¨‹å¼åç¨±
   - é¸æ“‡å®‰è£ä½ç½®
   - æ·»åŠ æª”æ¡ˆ
   - è¨­å®šå®‰è£è…³æœ¬
   - å»ºç«‹ .pkg

### macOS .dmg æ‰“åŒ…

```bash
#!/bin/bash
# å‰µå»º build-dmg.sh

APP_NAME="OpenClaw Token Dashboard"
VERSION="2.0.0"
DMG_NAME="$APP_NAME-$VERSION.dmg"

# 1. å‰µå»ºæš«å­˜è³‡æ–™å¤¾
mkdir -p build/dmg
cp -r * build/dmg/

# 2. å‰µå»ºè‡ªè¨‚èƒŒæ™¯ï¼ˆå¯é¸ï¼‰
mkdir build/dmg/.background
cp assets/dmg-background.png build/dmg/.background/

# 3. å‰µå»º DMG
hdiutil create -volname "$APP_NAME" \
  -srcfolder build/dmg \
  -ov -format UDZO \
  "dist/$DMG_NAME"

echo "âœ… DMG å·²å‰µå»º: dist/$DMG_NAME"
```

### Windows .exe æ‰“åŒ…

#### ä½¿ç”¨ Inno Setup

1. **å®‰è£ Inno Setup:**
   - https://jrsoftware.org/isdl.php
   - Windows å°ˆç”¨æ‰“åŒ…å·¥å…·

2. **å‰µå»ºå®‰è£è…³æœ¬ (`setup.iss`):**

```ini
[Setup]
AppName=OpenClaw Token Dashboard
AppVersion=2.0.0
DefaultDirName={pf}\OpenClaw Dashboard
DefaultGroupName=OpenClaw
OutputDir=dist
OutputBaseFilename=OpenClaw-Dashboard-Setup-2.0.0
Compression=lzma2
SolidCompression=yes
SetupIconFile=assets\icon.ico
WizardStyle=modern

[Files]
Source: "*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs

[Icons]
Name: "{group}\OpenClaw Dashboard"; Filename: "{app}\å•Ÿå‹• Dashboard.command"
Name: "{userdesktop}\OpenClaw Dashboard"; Filename: "{app}\å•Ÿå‹• Dashboard.command"

[Run]
Filename: "{app}\å•Ÿå‹• Dashboard.command"; Description: "å•Ÿå‹• Dashboard"; Flags: postinstall nowait skipifsilent

[Code]
// æª¢æŸ¥ Node.js
function InitializeSetup(): Boolean;
var
  ResultCode: Integer;
begin
  if not Exec('cmd.exe', '/c node --version', '', SW_HIDE, ewWaitUntilTerminated, ResultCode) then
  begin
    MsgBox('è«‹å…ˆå®‰è£ Node.js!', mbError, MB_OK);
    Result := False;
  end
  else
    Result := True;
end;
```

3. **ç·¨è­¯:**
   - é–‹å•Ÿ Inno Setup Compiler
   - è¼‰å…¥ `setup.iss`
   - é»žæ“Šã€ŒCompileã€
   - ç”¢ç”Ÿ `dist/OpenClaw-Dashboard-Setup-2.0.0.exe`

---

## ðŸŽ¯ æ–¹æ¡ˆæ¯”è¼ƒ

| åŠŸèƒ½ | Electron æ‡‰ç”¨ | å‚³çµ±å®‰è£åŒ… |
|------|--------------|-----------|
| **è·¨å¹³å°** | âœ… ä¸€æ¬¡é–‹ç™¼ | âŒ åˆ†åˆ¥é–‹ç™¼ |
| **ä½¿ç”¨é«”é©—** | â­â­â­â­â­ å°ˆæ¥­ | â­â­â­ æ™®é€š |
| **å®‰è£å¤§å°** | ~100-150 MB | ~10 MB |
| **è‡ªå‹•æ›´æ–°** | âœ… å…§å»º | âŒ éœ€è‡ªè¡Œå¯¦ä½œ |
| **ç³»çµ±æ‰˜ç›¤** | âœ… | âŒ |
| **é–‹æ©Ÿè‡ªå•Ÿ** | âœ… | âš ï¸ éœ€æ‰‹å‹•è¨­å®š |
| **ä¸éœ€ Node.js** | âœ… å…§å»º | âŒ ç”¨æˆ¶éœ€å®‰è£ |
| **é–‹ç™¼é›£åº¦** | â­â­â­ ä¸­ç­‰ | â­â­â­â­ è¼ƒé›£ |
| **ç¶­è­·æˆæœ¬** | â­â­ ä½Ž | â­â­â­â­ é«˜ |

---

## ðŸ’¡ æŽ¨è–¦æ–¹æ¡ˆ

### ðŸ† çµ¦ä¸€èˆ¬ä½¿ç”¨è€…åˆ†äº«ï¼šElectron æ‰“åŒ…

**å„ªé»žï¼š**
- âœ… åƒä¸€èˆ¬è»Ÿé«”ä¸€æ¨£ä½¿ç”¨
- âœ… é›™æ“Šå®‰è£ï¼Œä¸éœ€è¦çµ‚ç«¯æ©Ÿ
- âœ… ç³»çµ±æ‰˜ç›¤å¸¸é§
- âœ… è·¨å¹³å°æ”¯æ´
- âœ… å°ˆæ¥­å½¢è±¡

**é©åˆï¼š**
- æƒ³çµ¦éžæŠ€è¡“èƒŒæ™¯çš„æœ‹å‹ä½¿ç”¨
- å¸Œæœ›æä¾›å°ˆæ¥­çš„ä½¿ç”¨é«”é©—
- éœ€è¦è·¨å¹³å°æ”¯æ´

### ðŸŽ¯ çµ¦é–‹ç™¼è€…åˆ†äº«ï¼šç•¶å‰æ–¹å¼ (.command + .zip)

**å„ªé»žï¼š**
- âœ… æª”æ¡ˆå°ï¼ˆ~5 MBï¼‰
- âœ… å¯ä»¥æŸ¥çœ‹å’Œä¿®æ”¹ç¨‹å¼ç¢¼
- âœ… å¿«é€Ÿåˆ†äº«

**é©åˆï¼š**
- æŠ€è¡“èƒŒæ™¯çš„æœ‹å‹
- æƒ³è¦å®¢è£½åŒ–çš„ä½¿ç”¨è€…
- å¿«é€Ÿæ¸¬è©¦å’Œé–‹ç™¼

---

## ðŸš€ å»ºè­°å¯¦ä½œé †åº

### éšŽæ®µä¸€ï¼šç•¶å‰æ–¹å¼ï¼ˆå·²å®Œæˆï¼‰âœ…
```
.command é›™æ“Šå•Ÿå‹• + .zip æ‰“åŒ…
```

### éšŽæ®µäºŒï¼šElectron æ¡Œé¢æ‡‰ç”¨
```
1. æœ¬é€±ï¼šå¯¦ä½œ Electron åŸºæœ¬åŠŸèƒ½
2. æ¸¬è©¦ï¼šåœ¨ macOS å’Œ Windows ä¸Šæ¸¬è©¦
3. æ‰“åŒ…ï¼šç”Ÿæˆå®‰è£æª”æ¡ˆ
4. åˆ†äº«ï¼šçµ¦æœ‹å‹æ¸¬è©¦
```

### éšŽæ®µä¸‰ï¼šé€²éšŽåŠŸèƒ½
```
- è‡ªå‹•æ›´æ–°
- å¤šèªžè¨€æ”¯æ´
- è‡ªè¨‚ä¸»é¡Œ
- æ•¸æ“šå°Žå‡º
```

---

## ðŸ“ å¿«é€Ÿæ±ºç­–

**Q: æˆ‘æ‡‰è©²é¸å“ªå€‹æ–¹æ¡ˆï¼Ÿ**

### é¸ Electron å¦‚æžœï¼š
- âœ… æƒ³è¦å°ˆæ¥­çš„å®‰è£é«”é©—
- âœ… ç›®æ¨™ç”¨æˆ¶éžæŠ€è¡“èƒŒæ™¯
- âœ… éœ€è¦è·¨å¹³å°æ”¯æ´
- âœ… é¡˜æ„æŠ•å…¥æ™‚é–“é–‹ç™¼

### é¸å‚³çµ±æ‰“åŒ…å¦‚æžœï¼š
- âœ… åªéœ€è¦ macOS æˆ– Windows
- âœ… æª”æ¡ˆå¤§å°å¾ˆé‡è¦
- âœ… å¿«é€Ÿåˆ†äº«çµ¦å°‘æ•¸äºº
- âœ… ç”¨æˆ¶æœ‰æŠ€è¡“èƒŒæ™¯

### ç¶­æŒç•¶å‰æ–¹å¼å¦‚æžœï¼š
- âœ… åªçµ¦é–‹ç™¼è€…æœ‹å‹ç”¨
- âœ… ç¶“å¸¸éœ€è¦æ›´æ–°ç¨‹å¼ç¢¼
- âœ… å¿«é€Ÿè¿­ä»£æ¸¬è©¦
- âœ… æª”æ¡ˆå¤§å°æœ€å°åŒ–

---

**æ‚¨æƒ³è¦å¯¦ä½œå“ªå€‹æ–¹æ¡ˆï¼Ÿæˆ‘å¯ä»¥ç«‹å³å¹«æ‚¨å»ºç«‹ï¼** ðŸš€

æŽ¨è–¦ï¼š**Electron æ–¹æ¡ˆ** - æœ€å°ˆæ¥­ã€æœ€ä½³ä½¿ç”¨é«”é©—ï¼
